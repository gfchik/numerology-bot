import logging
import re
from typing import Dict
from telegram import Update
from telegram.ext import (
    Application,
    CommandHandler,
    MessageHandler,
    ContextTypes,
    ConversationHandler,
    filters
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è ConversationHandler
NAME, BIRTH_DATE = range(2)

# –ë–∞–∑–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –±—É–∫–≤ –∏ —Ü–∏—Ñ—Ä (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
LETTER_TO_NUMBER = {
    '–∞': 1, '–±': 2, '–≤': 3, '–≥': 4, '–¥': 5, '–µ': 6, '—ë': 7, '–∂': 8, '–∑': 9,
    '–∏': 1, '–π': 2, '–∫': 3, '–ª': 4, '–º': 5, '–Ω': 6, '–æ': 7, '–ø': 8, '—Ä': 9,
    '—Å': 1, '—Ç': 2, '—É': 3, '—Ñ': 4, '—Ö': 5, '—Ü': 6, '—á': 7, '—à': 8, '—â': 9,
    '—ä': 1, '—ã': 2, '—å': 3, '—ç': 4, '—é': 5, '—è': 6
}

# –ü–û–õ–ù–ê–Ø –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π: –æ–ø–∏—Å–∞–Ω–∏—è —á–∏—Å–µ–ª
NUMBER_DESCRIPTIONS = {
    1: {
        "title": "–õ–ò–î–ï–†, –ü–ï–†–í–û–û–¢–ö–†–´–í–ê–¢–ï–õ–¨",
        "strength": "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞, —Å–º–µ–ª–æ—Å—Ç—å",
        "description": "–í—ã —Ä–æ–∂–¥–µ–Ω—ã, —á—Ç–æ–±—ã –±—ã—Ç—å –ø–µ—Ä–≤—ã–º ‚Äî –≤–µ—Å—Ç–∏ –∑–∞ —Å–æ–±–æ–π, —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤–æ–µ –∏ –≤–æ–ø–ª–æ—â–∞—Ç—å –∏–¥–µ–∏ –≤ –∂–∏–∑–Ω—å.",
        "advice_weak": ["–ù–∞—á–Ω–∏—Ç–µ —Å –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å", "–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ—Å—å –≥–æ–≤–æ—Ä–∏—Ç—å '–Ω–µ—Ç' –≤ –º–µ–ª–æ—á–∞—Ö", "–ó–∞–≤–µ–¥–∏—Ç–µ –¥–Ω–µ–≤–Ω–∏–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π"],
        "advice_strong": ["–ë–µ—Ä–∏—Ç–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–∞–º–∏", "–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ –∫–æ–Ω–∫—É—Ä—Å–∞—Ö", "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ"]
    },
    2: {
        "title": "–î–ò–ü–õ–û–ú–ê–¢, –ú–ò–†–û–¢–í–û–†–ï–¶",
        "strength": "–ß—É—Ç–∫–æ—Å—Ç—å, —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, —Ç–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å",
        "description": "–í—ã ‚Äî –∫–æ–º–∞–Ω–¥–Ω—ã–π –∏–≥—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∞—Ä–º–æ–Ω–∏—é –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–±—â–∏–π —è–∑—ã–∫ —Å –∫–µ–º —É–≥–æ–¥–Ω–æ.",
        "advice_weak": ["–ë–æ–ª—å—à–µ –æ–±—â–∞–π—Ç–µ—Å—å —Å –ª—é–¥—å–º–∏", "–ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å –ø–∞—Ä–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ —Å–ø–æ—Ä—Ç–∞", "–£—á–∏—Ç–µ—Å—å –ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É"],
        "advice_strong": ["–ë—É–¥—å—Ç–µ –¥–∏–ø–ª–æ–º–∞—Ç–æ–º –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö", "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥–∞—Ä–º–æ–Ω–∏—é –≤ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–µ", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —ç–º–ø–∞—Ç–∏—é"]
    },
    3: {
        "title": "–¢–í–û–†–ï–¶, –û–ü–¢–ò–ú–ò–°–¢",
        "strength": "–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –æ–±–∞—è–Ω–∏–µ, —Ä–∞–¥–æ—Å—Ç—å –∂–∏–∑–Ω–∏",
        "description": "–í—ã ‚Äî –¥—É—à–∞ –∫–æ–º–ø–∞–Ω–∏–∏, –≤–∞—à –æ–ø—Ç–∏–º–∏–∑–º –∑–∞—Ä–∞–∑–∏—Ç–µ–ª–µ–Ω. –í—ã —É–º–µ–µ—Ç–µ –≤—ã—Ä–∞–∂–∞—Ç—å —Å–µ–±—è —á–µ—Ä–µ–∑ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ.",
        "advice_weak": ["–ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã", "–ë–æ–ª—å—à–µ –æ–±—â–∞–π—Ç–µ—Å—å —Å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ –ª—é–¥—å–º–∏", "–í–µ–¥–∏—Ç–µ –¥–Ω–µ–≤–Ω–∏–∫ –∏–¥–µ–π"],
        "advice_strong": ["–í—ã—Ä–∞–∂–∞–π—Ç–µ —Å–µ–±—è —á–µ—Ä–µ–∑ –∏—Å–∫—É—Å—Å—Ç–≤–æ", "–í–¥–æ—Ö–Ω–æ–≤–ª—è–π—Ç–µ –¥—Ä—É–≥–∏—Ö —Å–≤–æ–∏–º –æ–ø—Ç–∏–º–∏–∑–º–æ–º", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏"]
    },
    4: {
        "title": "–ü–†–ê–ö–¢–ò–ö, –°–¢–†–û–ò–¢–ï–õ–¨",
        "strength": "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å, —Ç—Ä—É–¥–æ–ª—é–±–∏–µ, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞",
        "description": "–í—ã ‚Äî –æ—Å–Ω–æ–≤–∞ –æ—Å–Ω–æ–≤. –í—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç–µ —Ö–∞–æ—Ç–∏—á–Ω—ã–µ –∏–¥–µ–∏ –≤ –ø—Ä–æ—á–Ω—ã–µ –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.",
        "advice_weak": ["–°–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –ø–ª–∞–Ω—ã –Ω–∞ –¥–µ–Ω—å", "–ù–∞–≤–æ–¥–∏—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –≤ –¥–æ–º–µ/—Ä–∞–±–æ—Ç–µ", "–£—á–∏—Ç–µ—Å—å –¥–æ–≤–æ–¥–∏—Ç—å –¥–µ–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞"],
        "advice_strong": ["–°—Ç—Ä–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã", "–ë—É–¥—å—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º", "–û—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–æ–∫—Ä—É–≥"]
    },
    5: {
        "title": "–°–õ–ï–î–û–ü–´–¢, –°–í–û–ë–û–î–ù–´–ô –î–£–•",
        "strength": "–°–≤–æ–±–æ–¥–æ–ª—é–±–∏–µ, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å, –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
        "description": "–í—ã –æ–±–æ–∂–∞–µ—Ç–µ –ø–µ—Ä–µ–º–µ–Ω—ã, –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∏ –Ω–æ–≤—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è. –í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –ø–∏—Ç–∞–µ—Ç—Å—è –æ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è.",
        "advice_weak": ["–ü—Ä–æ–±—É–π—Ç–µ –Ω–æ–≤–æ–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å", "–ü—É—Ç–µ—à–µ—Å—Ç–≤—É–π—Ç–µ (—Ö–æ—Ç—è –±—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ)", "–û–±—â–∞–π—Ç–µ—Å—å —Å —Ä–∞–∑–Ω—ã–º–∏ –ª—é–¥—å–º–∏"],
        "advice_strong": ["–ò—â–∏—Ç–µ —Ä–∞–±–æ—Ç—É —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º", "–ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ —Å–ø–æ—Ä—Ç–∞", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –Ω–∞–≤—ã–∫ –±—ã—Å—Ç—Ä–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏"]
    },
    6: {
        "title": "–û–ü–ï–ö–£–ù, –•–†–ê–ù–ò–¢–ï–õ–¨ –û–ß–ê–ì–ê",
        "strength": "–ó–∞–±–æ—Ç–∞, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, —á—É–≤—Å—Ç–≤–æ –¥–æ–ª–≥–∞",
        "description": "–í—ã ‚Äî —Ç–æ—Ç, –∫—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —É—é—Ç, –≥–∞—Ä–º–æ–Ω–∏—é –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–ª–∏–∑–∫–∏—Ö. –í—ã ‚Äî —Å–µ—Ä–¥—Ü–µ —Å–µ–º—å–∏ –∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã.",
        "advice_weak": ["–ü—Ä–æ—è–≤–ª—è–π—Ç–µ –∑–∞–±–æ—Ç—É –æ —Å–µ–±–µ", "–ü–æ–º–æ–≥–∞–π—Ç–µ –¥—Ä—É–≥–∏–º –≤ –º–µ–ª–æ—á–∞—Ö", "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —É—é—Ç–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ"],
        "advice_strong": ["–ë–µ—Ä–∏—Ç–µ –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –±–ª–∏–∑–∫–∏—Ö", "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥–∞—Ä–º–æ–Ω–∏—é –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –≤–∫—É—Å"]
    },
    7: {
        "title": "–ê–ù–ê–õ–ò–¢–ò–ö, –ú–£–î–†–ï–¶",
        "strength": "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —É–º, –∏–Ω—Ç—É–∏—Ü–∏—è, –ª—é–±–æ–≤—å –∫ –∑–Ω–∞–Ω–∏—è–º",
        "description": "–í—ã ‚Äî –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –Ω–µ–≤–∏–¥–∏–º–æ–≥–æ. –í–∞—Å –≤–ª–µ–∫—É—Ç —Ç–∞–π–Ω—ã, –Ω–∞—É–∫–∞ –∏ –¥—É—Ö–æ–≤–Ω—ã–µ –ø–æ–∏—Å–∫–∏.",
        "advice_weak": ["–ß–∏—Ç–∞–π—Ç–µ –Ω–∞—É—á–Ω—É—é –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—É", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ", "–ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å —Å–∞–º–æ–∞–Ω–∞–ª–∏–∑–æ–º"],
        "advice_strong": ["–ü–æ–≥—Ä—É–∂–∞–π—Ç–µ—Å—å –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –∏–Ω—Ç—É–∏—Ü–∏—é", "–î–µ–ª–∏—Ç–µ—Å—å –∑–Ω–∞–Ω–∏—è–º–∏ —Å –¥—Ä—É–≥–∏–º–∏"]
    },
    8: {
        "title": "–õ–ò–î–ï–†, –ú–ê–ì–ù–ê–¢",
        "strength": "–°–∏–ª–∞ –≤–æ–ª–∏, –¥–µ–ª–æ–≤–∞—è —Ö–≤–∞—Ç–∫–∞, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è",
        "description": "–í—ã —Ä–æ–∂–¥–µ–Ω—ã, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏–≥–∞—Ç—å –±–æ–ª—å—à–∏—Ö —Ü–µ–ª–µ–π –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–º –º–∏—Ä–æ–º.",
        "advice_weak": ["–£—á–∏—Ç–µ—Å—å —É–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏", "–°—Ç–∞–≤—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–µ–ª–∏", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É"],
        "advice_strong": ["–ë–µ—Ä–∏—Ç–µ –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", "–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –±–∏–∑–Ω–µ—Å-–Ω–∞–≤—ã–∫–∏"]
    },
    9: {
        "title": "–ì–£–ú–ê–ù–ò–°–¢, –§–ò–õ–ê–ù–¢–†–û–ü",
        "strength": "–°–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ, –±–µ—Å–∫–æ—Ä—ã—Å—Ç–∏–µ, –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ",
        "description": "–í—ã ‚Äî —á–µ–ª–æ–≤–µ–∫ –º–∏—Ä–∞, –≤–∞—à–µ —Å–µ—Ä–¥—Ü–µ –æ—Ç–∫—Ä—ã—Ç–æ –¥–ª—è –≤—Å–µ—Ö. –í–∞—à–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Å–ª—É–∂–∏—Ç—å —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤—É.",
        "advice_weak": ["–ü–æ–º–æ–≥–∞–π—Ç–µ –¥—Ä—É–≥–∏–º –≤ –º–µ—Ä—É —Å–∏–ª", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —ç–º–ø–∞—Ç–∏—é", "–ò–∑—É—á–∞–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã"],
        "advice_strong": ["–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ –±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏", "–ù–µ—Å–∏—Ç–µ –¥–æ–±—Ä–æ –≤ –º–∏—Ä", "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏"]
    },
    11: {
        "title": "–ü–†–û–°–í–ï–¢–ò–¢–ï–õ–¨, –í–î–û–•–ù–û–í–ò–¢–ï–õ–¨",
        "strength": "–ò–Ω—Ç—É–∏—Ü–∏—è, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ",
        "description": "–í—ã ‚Äî –º–æ—Å—Ç –º–µ–∂–¥—É –º–∏—Ä–æ–º –∑–µ–º–Ω—ã–º –∏ –¥—É—Ö–æ–≤–Ω—ã–º. –í—ã –æ–±–ª–∞–¥–∞–µ—Ç–µ –æ–≥—Ä–æ–º–Ω—ã–º –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º.",
        "advice": ["–†–∞–∑–≤–∏–≤–∞–π—Ç–µ –∏–Ω—Ç—É–∏—Ü–∏—é", "–î–µ–ª–∏—Ç–µ—Å—å –¥—É—Ö–æ–≤–Ω—ã–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏", "–í–¥–æ—Ö–Ω–æ–≤–ª—è–π—Ç–µ –¥—Ä—É–≥–∏—Ö —Å–≤–æ–∏–º –ø—Ä–∏–º–µ—Ä–æ–º"]
    },
    22: {
        "title": "–ó–û–î–ß–ò–ô, –ú–ê–°–¢–ï–†-–°–¢–†–û–ò–¢–ï–õ–¨",
        "strength": "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–∏–∞–ª—å–Ω–æ—Å—Ç—å, –º–∞—Å—à—Ç–∞–±–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ",
        "description": "–í—ã —É–º–µ–µ—Ç–µ –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å –≥—Ä–∞–Ω–¥–∏–æ–∑–Ω—ã–µ –º–µ—á—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –º–∏—Ä–æ–≤–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞.",
        "advice": ["–ë–µ—Ä–∏—Ç–µ—Å—å –∑–∞ –±–æ–ª—å—à–∏–µ –ø—Ä–æ–µ–∫—Ç—ã", "–°–æ–µ–¥–∏–Ω—è–π—Ç–µ –∏–¥–µ–∏ —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π", "–°—Ç—Ä–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç"]
    },
    33: {
        "title": "–í–ï–õ–ò–ö–ò–ô –£–ß–ò–¢–ï–õ–¨, –ù–ï–°–£–©–ò–ô –°–í–ï–¢",
        "strength": "–ë–µ–∑—É—Å–ª–æ–≤–Ω–∞—è –ª—é–±–æ–≤—å, —Å–ª—É–∂–µ–Ω–∏–µ, –º—É–¥—Ä–æ—Å—Ç—å",
        "description": "–í—ã ‚Äî —á–µ–ª–æ–≤–µ–∫ —Å –æ–≥—Ä–æ–º–Ω—ã–º –¥—É—Ö–æ–≤–Ω—ã–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º, –ø—Ä–∏–∑–≤–∞–Ω–Ω—ã–π –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å, –∏—Å—Ü–µ–ª—è—Ç—å –∏ —É—á–∏—Ç—å –¥—Ä—É–≥–∏—Ö.",
        "advice": ["–ù–µ—Å–∏—Ç–µ —Å–≤–µ—Ç –≤ –º–∏—Ä", "–£—á–∏—Ç–µ —á–µ—Ä–µ–∑ –ª—é–±–æ–≤—å", "–ó–∞–±–æ—Ç—å—Ç–µ—Å—å –æ –¥—Ä—É–≥–∏—Ö, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ —Å–µ–±–µ"]
    }
}

class NumerologyCalculator:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π"""
    
    @staticmethod
    def reduce_to_single_digit(number: int) -> int:
        """–°–æ–∫—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –¥–æ –æ–¥–Ω–æ–π —Ü–∏—Ñ—Ä—ã, –∫—Ä–æ–º–µ –º–∞—Å—Ç–µ—Ä-—á–∏—Å–µ–ª"""
        if number in [11, 22, 33]:
            return number
        while number > 9:
            number = sum(int(digit) for digit in str(number))
        return number
    
    @staticmethod
    def calculate_life_path_number(birth_date: str) -> int:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ß–∏—Å–ª–æ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ü—É—Ç–∏"""
        try:
            digits = birth_date.replace('.', '')
            total = sum(int(d) for d in digits)
            return NumerologyCalculator.reduce_to_single_digit(total)
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —á–∏—Å–ª–∞ —Å—É–¥—å–±—ã: {e}")
            return 0
    
    @staticmethod
    def calculate_expression_number(name: str) -> int:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ß–∏—Å–ª–æ –ò–º–µ–Ω–∏"""
        name = name.lower().replace(' ', '')
        total = 0
        for letter in name:
            if letter in LETTER_TO_NUMBER:
                total += LETTER_TO_NUMBER[letter]
        return NumerologyCalculator.reduce_to_single_digit(total)
    
    @staticmethod
    def calculate_pythagoras_square(birth_date: str) -> Dict[str, int]:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ö–≤–∞–¥—Ä–∞—Ç –ü–∏—Ñ–∞–≥–æ—Ä–∞"""
        try:
            day, month, year = map(int, birth_date.split('.'))
            
            day_str = str(day).zfill(2)
            month_str = str(month).zfill(2)
            year_str = str(year)
            
            # –ü–µ—Ä–≤–æ–µ —Ä–∞–±–æ—á–µ–µ —á–∏—Å–ª–æ
            all_digits = day_str + month_str + year_str
            first = sum(int(d) for d in all_digits)
            
            # –í—Ç–æ—Ä–æ–µ —Ä–∞–±–æ—á–µ–µ —á–∏—Å–ª–æ
            second = sum(int(d) for d in str(first))
            
            # –¢—Ä–µ—Ç—å–µ —Ä–∞–±–æ—á–µ–µ —á–∏—Å–ª–æ
            first_digit_of_day = int(day_str[0])
            third = first - (first_digit_of_day * 2)
            third = sum(int(d) for d in str(abs(third)))
            
            # –ß–µ—Ç–≤–µ—Ä—Ç–æ–µ —Ä–∞–±–æ—á–µ–µ —á–∏—Å–ª–æ
            fourth = sum(int(d) for d in str(third))
            
            # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —Ü–∏—Ñ—Ä—ã
            all_numbers = all_digits + str(first) + str(second) + str(third) + str(fourth)
            
            # –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–π —Ü–∏—Ñ—Ä—ã
            square = {}
            for i in range(1, 10):
                square[str(i)] = all_numbers.count(str(i))
            
            return square
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –∫–≤–∞–¥—Ä–∞—Ç–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞: {e}")
            return {str(i): 0 for i in range(1, 10)}
    
    @staticmethod
    def get_combined_advice(life_path: int, expression: int, square: Dict[str, int]) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"""
        advice = []
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ß–∏—Å–ª—É –°—É–¥—å–±—ã
        lp_data = NUMBER_DESCRIPTIONS.get(life_path, {})
        if lp_data:
            if 'advice' in lp_data:
                advice.extend(lp_data['advice'])
            elif 'advice_strong' in lp_data:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏–ª—É –≤–æ–ª–∏ –≤ –∫–≤–∞–¥—Ä–∞—Ç–µ –ü–∏—Ñ–∞–≥–æ—Ä–∞ (—Ü–∏—Ñ—Ä–∞ 1)
                will_power = square.get('1', 0)
                if will_power >= 2:
                    advice.extend(lp_data.get('advice_strong', []))
                else:
                    advice.extend(lp_data.get('advice_weak', []))
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ß–∏—Å–ª—É –ò–º–µ–Ω–∏
        exp_data = NUMBER_DESCRIPTIONS.get(expression, {})
        if exp_data:
            if 'advice' in exp_data:
                advice.extend(exp_data['advice'])
            elif 'advice_strong' in exp_data:
                advice.extend(exp_data.get('advice_strong', []))
        
        # –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
        if life_path == 8 and expression == 5:
            advice.append("üíº –ò–¥–µ–∞–ª—å–Ω–∞—è –∫–∞—Ä—å–µ—Ä–∞: –±–∏–∑–Ω–µ—Å —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –∏–ª–∏ —Ñ—Ä–∏–ª–∞–Ω—Å –Ω–∞ —Ä—É–∫–æ–≤–æ–¥—è—â–µ–π –ø–æ–∑–∏—Ü–∏–∏")
        
        if life_path == 2 and expression == 6:
            advice.append("‚ù§Ô∏è –í–∞—à–µ –ø—Ä–∏–∑–≤–∞–Ω–∏–µ: —Ä–∞–±–æ—Ç–∞ —Å –ª—é–¥—å–º–∏, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è, –º–µ–¥–∏—Ü–∏–Ω–∞ –∏–ª–∏ –ø–µ–¥–∞–≥–æ–≥–∏–∫–∞")
        
        if life_path == 1 and expression == 7:
            advice.append("üî¨ –°–æ—á–µ—Ç–∞–Ω–∏–µ –ª–∏–¥–µ—Ä—Å—Ç–≤–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: –≤—ã –º–æ–∂–µ—Ç–µ —Å—Ç–∞—Ç—å –Ω–∞—É—á–Ω—ã–º —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º –∏–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–º-–Ω–æ–≤–∞—Ç–æ—Ä–æ–º")
        
        # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
        unique_advice = list(dict.fromkeys(advice))[:5]
        
        return "\n‚Ä¢ ".join(unique_advice) if unique_advice else "–î–æ–≤–µ—Ä—è–π—Ç–µ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏ –∏ —Å–ª–µ–¥—É–π—Ç–µ –∑–æ–≤—É —Å–µ—Ä–¥—Ü–∞."

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """–ù–∞—á–∞–ª–æ –¥–∏–∞–ª–æ–≥–∞"""
    await update.message.reply_text(
        "üîÆ *–ü—Ä–∏–≤–µ—Ç! –Ø NumeroBot ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –Ω—É–º–µ—Ä–æ–ª–æ–≥!*\n\n"
        "–Ø –ø–æ–º–æ–≥—É –≤–∞–º —É–∑–Ω–∞—Ç—å –æ –≤–∞—à–∏—Ö:\n"
        "‚ú® –¢–∞–ª–∞–Ω—Ç–∞—Ö –∏ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö\n"
        "üéØ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏\n"
        "üí´ –°–∫—Ä—ã—Ç—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö\n\n"
        "–î–ª—è –Ω–∞—á–∞–ª–∞ *–≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è* (–∫–∞–∫ –≤ –ø–∞—Å–ø–æ—Ä—Ç–µ):",
        parse_mode='Markdown'
    )
    return NAME

async def get_name(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """–ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    user_name = update.message.text.strip()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤ –∏–º–µ–Ω–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –±—É–∫–≤—ã
    if not any(char.isalpha() for char in user_name):
        await update.message.reply_text(
            "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ –∏–º—è —Å –±—É–∫–≤–∞–º–∏.\n"
            "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑:"
        )
        return NAME
    
    context.user_data['name'] = user_name
    
    await update.message.reply_text(
        f"üë§ –û—Ç–ª–∏—á–Ω–æ*!\n\n"
        "–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à—É *–¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è* –≤ —Ñ–æ—Ä–º–∞—Ç–µ:\n"
        "`–î–î.–ú–ú.–ì–ì–ì–ì`\n\n"
        "–ù–∞–ø—Ä–∏–º–µ—Ä: `15.03.1990`",
        parse_mode='Markdown'
    )
    return BIRTH_DATE

async def get_birth_date(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """–ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ä–∞—Å—á–µ—Ç"""
    birth_date = update.message.text.strip()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
    date_pattern = r'^\d{2}\.\d{2}\.\d{4}$'
    if not re.match(date_pattern, birth_date):
        await update.message.reply_text(
            "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã.\n"
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ `–î–î.–ú–ú.–ì–ì–ì–ì`\n"
            "–ù–∞–ø—Ä–∏–º–µ—Ä: `25.08.1991`",
            parse_mode='Markdown'
        )
        return BIRTH_DATE
    
    try:
        day, month, year = map(int, birth_date.split('.'))
        # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞—Ç—ã
        if not (1 <= day <= 31 and 1 <= month <= 12 and 1900 <= year <= 2100):
            raise ValueError
    except ValueError:
        await update.message.reply_text(
            "‚ùå –î–∞—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.\n"
            "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–∞—Ç—É:"
        )
        return BIRTH_DATE
    
    context.user_data['birth_date'] = birth_date
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–∞—Å—á–µ—Ç–µ
    calculating_msg = await update.message.reply_text("üîÆ *–†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é –≤–∞—à–∏ —á–∏—Å–ª–∞...*", parse_mode='Markdown')
    
    # –ü—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ä–∞—Å—á–µ—Ç—ã
    calculator = NumerologyCalculator()
    life_path = calculator.calculate_life_path_number(birth_date)
    expression = calculator.calculate_expression_number(context.user_data['name'])
    square = calculator.calculate_pythagoras_square(birth_date)
    
    # –ü–æ–ª—É—á–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏—è
    lp_data = NUMBER_DESCRIPTIONS.get(life_path, {})
    exp_data = NUMBER_DESCRIPTIONS.get(expression, {})
    
    # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    advice = calculator.get_combined_advice(life_path, expression, square)
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –∫–≤–∞–¥—Ä–∞—Ç –ü–∏—Ñ–∞–≥–æ—Ä–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    square_text = ""
    for i in range(1, 10):
        count = square.get(str(i), 0)
        quality = ""
        if i == 1:
            quality = "‚Äî –•–∞—Ä–∞–∫—Ç–µ—Ä, –≤–æ–ª—è"
        elif i == 2:
            quality = "‚Äî –≠–Ω–µ—Ä–≥–∏—è"
        elif i == 3:
            quality = "‚Äî –ò–Ω—Ç–µ—Ä–µ—Å –∫ –Ω–∞—É–∫–∞–º"
        elif i == 4:
            quality = "‚Äî –ó–¥–æ—Ä–æ–≤—å–µ"
        elif i == 5:
            quality = "‚Äî –õ–æ–≥–∏–∫–∞, –∏–Ω—Ç—É–∏—Ü–∏—è"
        elif i == 6:
            quality = "‚Äî –°–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ —Ç—Ä—É–¥—É"
        elif i == 7:
            quality = "‚Äî –í–µ–∑–µ–Ω–∏–µ"
        elif i == 8:
            quality = "‚Äî –ß—É–≤—Å—Ç–≤–æ –¥–æ–ª–≥–∞"
        elif i == 9:
            quality = "‚Äî –ü–∞–º—è—Ç—å, –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"
        
        if count > 0:
            square_text += f"‚Ä¢ {i} √ó {count} {quality}\n"
        else:
            square_text += f"‚Ä¢ {i} √ó 0 {quality} (–Ω—É–∂–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å)\n"
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
    result_text = (
        f"üéØ *–í–ê–® –ù–£–ú–ï–†–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –ü–û–†–¢–†–ï–¢*\n\n"
        f"üë§ *–ò–º—è:* {context.user_data['name']}\n"
        f"üìÖ *–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:* {birth_date}\n\n"
        f"‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        f"üî¢ *–û–°–ù–û–í–ù–´–ï –ß–ò–°–õ–ê*\n\n"
        f"üåü *–ß–∏—Å–ª–æ –°—É–¥—å–±—ã:* **{life_path}**\n"
        f"*{lp_data.get('title', '–û—Å–æ–±–æ–µ —á–∏—Å–ª–æ')}*\n"
        f"*–°–∏–ª–∞:* {lp_data.get('strength', '')}\n"
        f"_{lp_data.get('description', '–£–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–π')}_\n\n"
        f"üí´ *–ß–∏—Å–ª–æ –ò–º–µ–Ω–∏:* **{expression}**\n"
        f"*{exp_data.get('title', '–û—Å–æ–±–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ')}*\n"
        f"*–°–∏–ª–∞:* {exp_data.get('strength', '')}\n"
        f"_{exp_data.get('description', '–û—Å–æ–±—ã–π —Å–ø–æ—Å–æ–± —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è')}_\n\n"
        f"üìä *–ö–í–ê–î–†–ê–¢ –ü–ò–§–ê–ì–û–†–ê (–ø—Å–∏—Ö–æ–º–∞—Ç—Ä–∏—Ü–∞):*\n"
        f"{square_text}\n"
        f"‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        f"üí° *–ü–ï–†–°–û–ù–ê–õ–¨–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*\n\n"
        f"‚Ä¢ {advice}\n\n"
        f"‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        f"‚ú® *–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∑–Ω–∞–Ω–∏—è –¥–ª—è:*\n"
        f"‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏—è —Å–≤–æ–∏—Ö —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω\n"
        f"‚Ä¢ –í—ã–±–æ—Ä–∞ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–∏\n"
        f"‚Ä¢ –£–ª—É—á—à–µ–Ω–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π\n"
        f"‚Ä¢ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞\n\n"
        f"_–≠—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏—è, –∞ –Ω–µ –ø—Ä–∏–≥–æ–≤–æ—Ä._"
    )
    
    # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é"
    await context.bot.delete_message(
        chat_id=calculating_msg.chat_id,
        message_id=calculating_msg.message_id
    )
    
    await update.message.reply_text(result_text, parse_mode='Markdown')
    
    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç
    await update.message.reply_text(
        "üîÑ –•–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Ä–∞—Å—á–µ—Ç –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞? –ù–∞–∂–º–∏—Ç–µ /start"
    )
    
    return ConversationHandler.END

async def cancel(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """–û—Ç–º–µ–Ω–∞ –¥–∏–∞–ª–æ–≥–∞"""
    await update.message.reply_text(
        "‚ùå –†–∞—Å—á–µ—Ç –æ—Ç–º–µ–Ω–µ–Ω. –ï—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞ ‚Äî –Ω–∞–∂–º–∏—Ç–µ /start"
    )
    return ConversationHandler.END

def main() -> None:
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
    import os
TOKEN = os.getenv('TOKEN')
    
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(TOKEN).build()
    
    # –°–æ–∑–¥–∞–µ–º ConversationHandler
    conv_handler = ConversationHandler(
        entry_points=[CommandHandler('start', start)],
        states={
            NAME: [MessageHandler(filters.TEXT & ~filters.COMMAND, get_name)],
            BIRTH_DATE: [MessageHandler(filters.TEXT & ~filters.COMMAND, get_birth_date)],
        },
        fallbacks=[CommandHandler('cancel', cancel)],
    )
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    application.add_handler(conv_handler)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω! –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.")
    application.run_polling(allowed_updates=Update.ALL_TYPES)

if __name__ == '__main__':

    main()
